import{_ as s,c as i,o as a,a4 as n,cB as e,cC as t,cD as l,cE as h}from"./chunks/framework.Dcf-1z4i.js";const B=JSON.parse('{"title":"踩过的坑","description":"","frontmatter":{"layout":"doc","aside":false},"headers":[],"relativePath":"docs/linux/k8s/ingress安装问题.md","filePath":"docs/linux/k8s/ingress安装问题.md","lastUpdated":1718699027000}'),p={name:"docs/linux/k8s/ingress安装问题.md"},k=n('<h1 id="踩过的坑" tabindex="-1">踩过的坑 <a class="header-anchor" href="#踩过的坑" aria-label="Permalink to &quot;踩过的坑&quot;">​</a></h1><h2 id="the-connection-to-the-server-lb-kubesphere-local-6443-was-refused-did-you-specify-the-right-host" tabindex="-1">The connection to the server lb.kubesphere.local:6443 was refused - did you specify the right host.. <a class="header-anchor" href="#the-connection-to-the-server-lb-kubesphere-local-6443-was-refused-did-you-specify-the-right-host" aria-label="Permalink to &quot;The connection to the server lb.kubesphere.local:6443 was refused - did you specify the right host..&quot;">​</a></h2><p><a href="https://blog.csdn.net/weixin_50135832/article/details/139562948?spm=1001.2014.3001.5502" target="_blank" rel="noreferrer">我已经解决了写在csdn中</a></p><h2 id="dashboard-安装" tabindex="-1">dashboard 安装 <a class="header-anchor" href="#dashboard-安装" aria-label="Permalink to &quot;dashboard 安装&quot;">​</a></h2><p><img src="'+e+'" alt=""> 需要在浏览器中输入<code>thisisunsafe</code>,即可进入登录页面 <img src="'+t+`" alt=""></p><h2 id="ingress-安装的问题" tabindex="-1">ingress 安装的问题 <a class="header-anchor" href="#ingress-安装的问题" aria-label="Permalink to &quot;ingress 安装的问题&quot;">​</a></h2><p>问题描述： 安装后通过命令 <code>kubectl get pod,svc -n ingress-nginx</code> 查看是否成功</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[root@k8s-master </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]# kubectl get pod,svc -n ingress-nginx</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">NAME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                                            READY</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   STATUS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">               RESTARTS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   AGE</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pod/ingress-nginx-controller-68466b9c78-p4wq9</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   0/1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">     ContainerCreating</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">     0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">          35m</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">NAME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                                         TYPE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        CLUSTER-IP</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    EXTERNAL-IP</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   PORT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">S</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)                      </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">AGE</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">service/ingress-nginx-controller</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">             NodePort</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    10.96.47.75</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">   &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">non</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">e</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        80:31885/TCP,443:30125/TCP</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   35m</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">service/ingress-nginx-controller-admission</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   ClusterIP</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   10.96.36.48</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">   &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">non</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">e</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        443/TCP</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                      35m</span></span></code></pre></div><p>35m后了，pod肯定出现错误了，查看日志</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> describe</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pod</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  ingress-nginx-controller-68466b9c78-p4wq9</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ingress-nginx</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#...</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#kubelet MountVolume.SetUp failed for volume “webhook-cert” : secret “ingress-nginx-admission” not found</span></span></code></pre></div><p>查看ingress的相关<code>secret</code></p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[root@k8s-master </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]# kubectl get secret -A</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ingress</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ingress-nginx</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">          default-token-86n8q</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                              kubernetes.io/service-account-token</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   3</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      41m</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ingress-nginx</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">          ingress-nginx-admission-token-6pwvg</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">              kubernetes.io/service-account-token</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   3</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      41m</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ingress-nginx</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">          ingress-nginx-token-4p9qk</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                        kubernetes.io/service-account-token</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   3</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      41m</span></span></code></pre></div><p><code>ingress-nginx-admission-token-6pwvg </code><br><code>ingress-nginx-controller-68466b9c78-p4wq9</code>的yaml文件里面<code>ingress-nginx-admission</code>不相同，所以报错</p><p>查看nginx-ingress-controller-8tqkqy的yaml文件，里面的secret是ingress-nginx-admission</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pod</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ingress-nginx-controller-68466b9c78-p4wq9</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ingress-nginx</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> yaml</span></span></code></pre></div><p>复制一个与ingress-nginx-controller-68466b9c78-p4wq9内容相同的secret，命名为ingress-nginx-admission</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#将ingress-nginx-controller-68466b9c78-p4wq9的yaml导出为文件secret.yaml</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> secret</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ingress-nginx-admission-token-6pwvg</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ingress-nginx</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> yaml</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> secret.yaml</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">vi</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> secret.yaml</span></span></code></pre></div><p>将name修改成ingress-nginx-admission 再执行命令，将secret进行添加</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apply</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> secret.yaml</span></span></code></pre></div><div class="tip custom-block"><p class="custom-block-title">TIP</p><blockquote><p>参考文章：<a href="https://blog.csdn.net/weixin_44593275/article/details/126322099" target="_blank" rel="noreferrer">https://blog.csdn.net/weixin_44593275/article/details/126322099</a></p></blockquote></div><h2 id="nginx-ingress-controller-failed-calling-webhook-closed" tabindex="-1">Nginx Ingress Controller - Failed Calling Webhook [closed] <a class="header-anchor" href="#nginx-ingress-controller-failed-calling-webhook-closed" aria-label="Permalink to &quot;Nginx Ingress Controller - Failed Calling Webhook [closed]&quot;">​</a></h2><p>这个问题困扰了我许久，最后在<a href="https://stackoverflow.com/questions/61616203/nginx-ingress-controller-failed-calling-webhook" target="_blank" rel="noreferrer">StackOverflow</a>上找到了解决的办法</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> delete</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -A</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ValidatingWebhookConfiguration</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ingress-nginx-admission</span></span></code></pre></div><h2 id="devops-流水线运行状态显示为-未运行" tabindex="-1">DevOps 流水线运行状态显示为“未运行” <a class="header-anchor" href="#devops-流水线运行状态显示为-未运行" aria-label="Permalink to &quot;DevOps 流水线运行状态显示为“未运行”&quot;">​</a></h2><div class="tip custom-block"><p class="custom-block-title"><a href="https://ask.kubesphere.io/forum/d/9277-devops-maven-is-offline/2" target="_blank" rel="noreferrer">kubesphere 开发者社区</a></p><ul><li>使用 devops-config 中这个 devops/password 替换 secret kubesphere-secret 中的 token；</li><li>使用 devops-config 中这个 devops/password，替换 kubesphere-config 中的 devops/password；</li><li>重启 Deployment ks-controller-manager ；</li></ul></div><p>之后修改完重启之后还是还是不行，最后修改了用户的密码，触发下账户同步，问题解决</p><h2 id="可以运行了但是一直卡在那里" tabindex="-1">可以运行了但是一直卡在那里 <a class="header-anchor" href="#可以运行了但是一直卡在那里" aria-label="Permalink to &quot;可以运行了但是一直卡在那里&quot;">​</a></h2><p><img src="`+l+'" alt="bug">)</p><p>这个问题的原因是没有命名空间<code>kubesphere-devops-worker</code></p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> create</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> namespace</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubesphere-devops-worker</span></span></code></pre></div><p>问题得以解决。</p><h2 id="maven-xxx-is-offline" tabindex="-1">maven-xxx is offline <a class="header-anchor" href="#maven-xxx-is-offline" aria-label="Permalink to &quot;maven-xxx is offline&quot;">​</a></h2><p><img src="'+h+`" alt=""> 查看对应的pod <code>MountVolume.SetUp failed for volume &quot;config-volume&quot; : configmap &quot;ks-devops-agent&quot; not found</code></p><p>之后创建了<code>ks-devops-agent</code>这个configmap，在命名空间中创建了<code>kubesphere-devops-worker</code>这个configmap，问题解决。 个人感觉千万不要用最新版的kubesphere，因为真的会出现很多很多的bug，真的有时候想放弃，最后选择了降版本，有的问题就不会出现。</p><h2 id="密码忘记了" tabindex="-1">密码忘记了 <a class="header-anchor" href="#密码忘记了" aria-label="Permalink to &quot;密码忘记了&quot;">​</a></h2><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> edit</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> usesr</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> admin</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> uses</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> admin</span></span></code></pre></div><h2 id="not-ready-after-5000-milliseconds" tabindex="-1">not ready after 5000 MILLISECONDS <a class="header-anchor" href="#not-ready-after-5000-milliseconds" aria-label="Permalink to &quot;not ready after 5000 MILLISECONDS&quot;">​</a></h2><p>在并行执行流水线中，就会出现此错误,之后在kubesphere 的开发者社区看到有解决方案。</p><blockquote><p>再有就是可以尝试修改下 jenkins-casc-config 这个 configmap 中，下面 jenkins-user.yaml 部分，maven 对应的 jnlp 容器的 memory 和 cpu limit 修改大点，再试试是否有好转。</p></blockquote><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> name:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;maven&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  namespace:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;kubesphere-devops-worker&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  label:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;maven&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  nodeUsageMode:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;EXCLUSIVE&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  idleMinutes:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  containers:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> name:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;maven&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    image:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;registry.cn-beijing.aliyuncs.com/kubesphereio/builder-maven:v3.2.0&quot;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    command</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;cat&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    args:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    ttyEnabled:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    privileged:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> false</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 增加CPU和内存资源请求与限制</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    resourceRequestCpu:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;500m&quot;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        # 原100m调整为500m</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    resourceLimitCpu:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;8000m&quot;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">         # 原4000m调整为8000m</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    resourceRequestMemory:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;1024Mi&quot;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">   # 原100Mi调整为1024Mi</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    resourceLimitMemory:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;16384Mi&quot;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 原8192Mi调整为16384Mi</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> name:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;jnlp&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    image:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;registry.cn-beijing.aliyuncs.com/kubesphereio/inbound-agent:4.10-2&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    args:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;^\${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">computer</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">jnlpmac</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">} ^\${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">computer</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">name</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}&quot;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 对jnlp容器的资源也进行相应的增加</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    resourceRequestCpu:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;200m&quot;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        # 原50m调整为200m</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    resourceLimitCpu:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;1000m&quot;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">         # 原500m调整为1000m</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    resourceRequestMemory:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;800Mi&quot;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 原400Mi调整为800Mi</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    resourceLimitMemory:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;3072Mi&quot;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     # 原1536Mi调整为3072Mi</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  workspaceVolume:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    emptyDirWorkspaceVolume:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      memory:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> false</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  volumes:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> hostPathVolume:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      hostPath:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;/var/run/docker.sock&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      mountPath:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;/var/run/docker.sock&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> hostPathVolume:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      hostPath:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;/var/data/jenkins_maven_cache&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      mountPath:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;/root/.m2&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> hostPathVolume:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      hostPath:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;/var/data/jenkins_sonar_cache&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      mountPath:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;/root/.sonar/cache&quot;</span></span></code></pre></div><p>但是调整了还是没有解决。 逛了一下 <a href="https://stackoverflow.com/search?q=not+ready+after+5000+MILLISECONDS" target="_blank" rel="noreferrer">StackOverFlow</a>、<a href="https://github.com/fabric8io/kubernetes-client/issues/3795" target="_blank" rel="noreferrer">github</a> 有关此问题的解决方案，里面解决方案都不能成功。我看到开发者社区中有人说超过十个并发就会有这个错误（不太准确），因为我正好十个，我就有个想法，为什么一定要并行执行，我把这并发十个微服务拆成两个小并发的执行，之后成功了。</p>`,41),r=[k];function o(d,F,g,c,y,u){return a(),i("div",null,r)}const b=s(p,[["render",o]]);export{B as __pageData,b as default};
