---
date:'2021-08-16'
---
# 黑苹果安装记录

## 1、想法的诞生

以前在大学的时候，有一个室友是小米安装的黑苹果，当时我也想安装但是为了上课还是放弃了，之后有了华为的matebook D 14 之后就继续想安装，但是弄了一整天之后，还是没有成功，主要也找不到资源，连镜像也没有下载成功，更别说EFI，于是第二次放弃。而现在华硕电脑在家闲置着，落满了灰，想安装黑苹果的想法愈演愈烈，而这次花费两天时间终于成功，所以对自己来说做事还是有耐心一点。成功安装界面如下：

![mac界面](/assets/image/macos/image-20240313103041734.png)


## 2、准备工作

- 软件
  - [DiskGenius](https://haconln.cn:8443/downloads/tools/DiskGenius.zip) 磁盘分区软件
  - **balenaEtcher** 制作u盘
  - todesk 远程控制
  - 如果你下载的镜像文件里面有pe系统那么只需要一个balenaEtcher就好，其他的辅助软件pe系统应该都会有
- 收集系统信息
  - 收集系统小工具很好用可以试试 [黑果在线]https://mac.fike.top/hdinfo/HDInfo.vbs 
  - 如下所示

![系统信息](/assets/image/macos/image-20240313105627469.png)

- 大于16G U盘

- 镜像文件

  - macOS Sierra (10.12)
  - macOS High Sierra (10.13)
  - macOS Mojave (10.14)
  - macOS Catalina (10.15)
  - macOS Big Sur (11.x)
  - macOS Monterey (12.x)
  - macOS Ventura (13.x)
  - **macOS 14.x**（未给出具体名称，但提及了开发者预览版Beta更新）
  - 下载镜像文件可以从10.12版本开始，下载镜像的地方有很多，但大多数都要小米的，我是纯纯的白嫖党，所以找了好久才发现了这个网站[**黑果小兵的部落阁**](https://blog.daliansky.net/)，里面的镜像文件足以让你安装黑苹果。

- EFI引导文件

  - 根据收集的系统信息在**github**上搜索自己的EFI引导加载文件，这个过程挺难的，需要有耐心，我自己下载了很多跟自己型号以及型号相似的型号的引导文件，大概下载了13个有5个通过测试，5个成功的EFI文件中只有一个有完整驱动。
  -    ![EFI测试](/assets/image/macos/image-20240313111422099.png)

  - 搜索的时候就是自己的型号,可以使用github高级搜索来限定条件  [github高级搜索](https://github.com/search/advanced)

## 3、制作启动盘

- DiskGenius
- TranMac

这两个软件都可以进行制作启动盘，不论用哪个软件都行，这部分很简单我没截屏，大概会花费5分钟左右，需要耐心一点。

## 4、设置BIOS

各个品牌的电脑进入BIOS各不相同，我的华硕使用ESC可以自定义进入启动盘，我的华为电脑一般使用F2/F12，其他品牌的电脑暂时没接触，可以上网搜索。安装黑苹果时，BIOS设置是关键步骤之一，以确保非苹果硬件能够兼容并成功引导macOS系统。以下是一些常见的BIOS设置调整项：

1. **UEFI模式**：
   - 确保电脑启动模式设置为UEFI而非Legacy BIOS模式。
2. **安全启动（Secure Boot）**：
   - 关闭安全启动功能，因为这通常会阻止未签名的引导加载程序加载。
3. **兼容性支持模块（CSM）/ 启动模式选择**：
   - 根据不同的主板和Clover/OpenCore引导方式，可能需要禁用或启用 CSM。
   - 对于较新系统且使用OpenCore作为引导加载器的情况，通常建议关闭CSM以优化UEFI环境下的引导。
4. **SATA控制器模式**：
   - 将硬盘接口模式设置为AHCI模式，因为macOS支持并需要AHCI模式来识别硬盘。
5. **VT-x/VT-d/AMD-V**：
   - 如果你的CPU支持虚拟化技术，确保它们被开启，这对某些macOS功能和稳定性有帮助。
6. **USB配置**：
   - 确保USB 3.x支持在XHCI模式下开启，避免USB设备在安装过程中出现不稳定问题。
7. **CFG Lock (MSR 0xE2)**：
   - 若主板支持修改此选项，应关闭写保护，以便在某些情况下允许对CPU微码进行必要调整。
8. **Boot Options/启动顺序**：
   - 设置从你将要安装macOS的媒介（如USB驱动器、SSD等）优先启动。
9. **其他特定设置**：
   - 某些主板上可能会有关于图形卡、声卡、网卡等设备的特殊选项，根据你的硬件配置和相关的黑苹果教程来调整这些设置。
10. **显存大小设置**：
    - 对于一些需要手动设置内置显卡显存大小的机型，在进入安装过程前需先通过BIOS或其他途径（如GRUB命令行）设定好显存大小。
    - 每个主板的BIOS界面和可用选项可能会有所不同，所以在具体操作时，请参照与您所用硬件相匹配的最新黑苹果安装指南来进行个性化设置。

## 5、磁盘划分及安装macos

- 介绍需要的系统分区

  1. **EFI系统分区**：

     - 大小通常为 200MB 到 500MB 左右，我设置了500M。
     - 类型为 EFI 系统分区（ESP），用于存储引导加载程序如Clover或OpenCore的相关文件。

  2. **Mac OS 扩展（日志式）分区**：

     - 这是你将要安装macOS系统的主分区。

     - 建议大小至少30GB以上，根据你的需求及可用硬盘空间可适当增大到60GB、100GB甚至更多，特别是如果你打算在上面安装大量应用和保存数据的话。

     - 格式化为APFS格式，这是macOS High Sierra及以后版本默认使用的文件系统，也可以在此步骤格式化exfat，mac其他格式，在安装的时候抹掉就可以选择APFS格式

  3. **数据分区（可选）**：

     -  如果你希望在同一块硬盘上存储Windows或者其他操作系统或者共享数据，可以创建额外的数据分区。
     - 可以按照需要分配合适的大小，并选择合适的文件系统，例如NTFS以便于与Windows系统兼容，或者继续使用APFS以便于macOS访问。

  4. **交换空间/虚拟内存分区（可选，但推荐）**：

     - 对于macOS，一般会创建一个名为“交换文件”的虚拟内存区域，这在物理内存不足时提供临时的扩展空间。如果不在逻辑卷管理中动态分配，你可以手动分配一块空间作为交换分区（HFS+或APFS格式下无需专门划分，系统会自动管理）。

  5. BIOS设置完毕之后先进入PE系统，调整磁盘分区。

- 具体操作

  1. 说明我的华硕有两个硬盘，第一块硬盘上（128G）安装了windows不打算动，第二块硬盘（1T）200G作为windows数据分区，其余的我将安装macos操作系统。
  2. 需要将硬盘转为GPT格式，如果说是GPT格式就不用管，如果是MBR就需要转。使用DIskGenius选择硬盘 右击就可以转。
  ![GPT](/assets/image/macos/WechatIMG33.jpg)
  3. 下一步就需要考虑是macos系统的引导分区放在哪里了，两个硬盘都可以放，如果放在第一块硬盘上就需要将MSR分区删除才能建立第二个ESP，因为windows系统也有ESP（里面存放EFI），而我是放在第二块硬盘上。
  4. 在第二块硬盘上建立主分区，300G，格式为exfat
    ![GPT](/assets/image/macos/WechatIMG36.jpg)
  5. 在第二块硬盘上建立ESP分区，500M，，格式fat32（建议现在还是不要将自己找的EFI拷贝到这里，因为我也不知道能不能成功）
    ![GPT](/assets/image/macos/WechatIMG32.jpg)
  6. 将自己EFI文件替换掉自己U盘启动EFI文件，关闭PE系统，使用u盘启动安装macos,启动后进入跑代码阶段，如果出现问题可以尝试解决问题（远景论坛，chatgpt等），如果解决不了，换另一个EFI文件，继续重试，直到可以看见macos安装界面。
   ![GPT](/assets/image/macos/WechatIMG34.jpg)
- macos安装

  1. 出现了安装界面，选择磁盘工具，继续
  2. 进入磁盘工具，选择显示所有设备
  3. 将创建的主分区抹掉，格式为APFS格式，名字MacOS就好，退出磁盘工具
  4. 返回安装界面，点击继续
  5. 点击同意，继续
  6. 阅读协议同意
  7. 选择要安装的磁盘卷标就是我命名为MacOS分区，继续
  8. 之后就安装，等啊等啊等啊，重启重启。。。出现了选择国家地区，当然中国大陆
  9. 键盘默认
  10. 辅助功能以后继续
  11. 网络连接设置，其他网络，暂不接入互联网
  12. 数据与隐私，继续
  13. 迁移助理，以后。。。。。不想写了，这些都是简单操作完成之后就进入系统
  14. **进入系统就证明可以安装完成，那么此时要将自己的EFI文件替换掉第二块硬盘中ESP分区中，因为现在使用的是优盘启动，换完之后，就可以拔掉优盘了，此时基本成功了。**

## 6、驱动下载

安装完黑苹果之后，对于没有驱动的设备，通常需要根据硬件的具体型号和规格去寻找对应的驱动程序，也就是常说的Kext文件。以下是下载未驱动设备驱动的一般步骤：

1. **识别硬件型号**：
   - 就是上面收集的信息，应该是一个info.html文件
2. **社区搜索与查阅**：
   - 访问相关的黑苹果社区论坛，比如远景论坛、TonyMacx86、InsanelyMac等，搜索你的硬件型号和macOS版本。
   - 查阅针对你特定硬件的安装教程和经验分享，通常这些资源中会包含所需的Kext驱动链接或者详细的安装方法。
3. **第三方驱动库下载**：
   - 黑苹果驱动之家、GitHub上的开源项目等地方常常会有用户贡献的驱动集合，找到对应硬件型号的Kext驱动进行下载。
4. **官方支持（如果有）**：
   - 对于某些硬件，尤其是显卡、声卡等，如果制造商提供对macOS的支持，则可以访问其官方网站查找相应的驱动程序。
5. **手动编译/修改**：
   - 在一些情况下，可能需要从源代码编译适合你硬件的驱动，或者对现有的Kext进行修改以适应非苹果硬件。
6. **安装与配置**：
   - 将下载的Kext文件放置在 `/Library/Extensions` 或 `/System/Library/Extensions` 目录下。
   - 重启电脑，并使用 Clover 或 OpenCore 的配置工具来加载新的驱动。
   - 运行 `sudo kextcache -i /` 命令重建内核扩展缓存。
   - 检查系统报告确认驱动是否已成功加载并工作正常。

请务必确保下载的驱动来源可靠，且与你的硬件及macOS版本兼容。同时，注意备份现有系统和EFI分区以防万一出现问题时能够恢复。





## 

